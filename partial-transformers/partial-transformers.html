

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Partial transformers &mdash; Chimney 0.7.2 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Migrating from Lifted Transformers" href="migrating-from-lifted.html" />
    <link rel="prev" title="Unsafe options (deprecated)" href="../transformers/unsafe-options.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> Chimney
          

          
          </a>

          
            
            
              <div class="version">
                0.7.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting-started/quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting-started/community.html">Community</a></li>
</ul>
<p class="caption"><span class="caption-text">Transformers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../transformers/getting-started.html">Getting started with transformers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../transformers/customizing-transformers.html">Customizing transformers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../transformers/standard-transformers.html">Standard transformers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../transformers/default-values.html">Default values support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../transformers/own-transformations.html">Plugging in own transformations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../transformers/scoped-configuration.html">Providing scoped configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../transformers/java-beans.html">Java beans</a></li>
<li class="toctree-l1"><a class="reference internal" href="../transformers/unsafe-options.html">Unsafe options <code class="docutils literal notranslate"><span class="pre">(deprecated)</span></code></a></li>
</ul>
<p class="caption"><span class="caption-text">Partial Transformers</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Partial transformers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#capturing-errors">Capturing errors</a></li>
<li class="toctree-l2"><a class="reference internal" href="#custom-error-messages">Custom error messages</a></li>
<li class="toctree-l2"><a class="reference internal" href="#partial-transformers-operations">Partial transformers operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#short-circuit-semantics">Short-circuit semantics</a></li>
<li class="toctree-l2"><a class="reference internal" href="#performance-notes">Performance notes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="migrating-from-lifted.html">Migrating from Lifted Transformers</a></li>
<li class="toctree-l1"><a class="reference internal" href="total-vs-partial-conflicts.html">Total vs partial conflicts</a></li>
<li class="toctree-l1"><a class="reference internal" href="cats-integration.html">Cats integration</a></li>
</ul>
<p class="caption"><span class="caption-text">Lifted Transformers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../lifted-transformers/lifted-transformers.html">Lifted Transformers <code class="docutils literal notranslate"><span class="pre">(deprecated)</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../lifted-transformers/cats-integration.html">Cats integration <code class="docutils literal notranslate"><span class="pre">(deprecated)</span></code></a></li>
</ul>
<p class="caption"><span class="caption-text">Patchers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../patchers/getting-started.html">Getting started with patchers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../patchers/redundant-fields.html">Redundant fields in patchers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../patchers/options-handling.html">Handling optional fields</a></li>
</ul>
<p class="caption"><span class="caption-text">Benchmarks</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../benchmarks.html">Benchmarks</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Chimney</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Partial transformers</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="partial-transformers">
<span id="id1"></span><h1>Partial transformers<a class="headerlink" href="#partial-transformers" title="Permalink to this headline">¶</a></h1>
<p>While Chimney transformers represent total functions of type <code class="docutils literal notranslate"><span class="pre">From</span> <span class="pre">=&gt;</span> <span class="pre">To</span></code>, they don’t
really support partial transformations which may either <cite>succeed</cite> or <cite>fail</cite>.</p>
<p>Let’s take a look at the following example.</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">case</span> <span class="k">class</span> <span class="nc">RegistrationForm</span><span class="o">(</span><span class="n">email</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span>
                            <span class="n">username</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span>
                            <span class="n">password</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span>
                            <span class="n">age</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span>

<span class="k">case</span> <span class="k">class</span> <span class="nc">RegisteredUser</span><span class="o">(</span><span class="n">email</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span>
                          <span class="n">username</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span>
                          <span class="n">passwordHash</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span>
                          <span class="n">age</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span>
</pre></div>
</div>
<p>We would like to hash the password and parse provided <code class="docutils literal notranslate"><span class="pre">age:</span> <span class="pre">String</span></code> field into a correct <code class="docutils literal notranslate"><span class="pre">Int</span></code>
or return an error, when the value is not valid integer. This is not possible using total
<code class="docutils literal notranslate"><span class="pre">Transformer</span></code> type.</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">import</span> <span class="nn">io.scalaland.chimney.dsl._</span>
<span class="k">import</span> <span class="nn">io.scalaland.chimney.partial</span>

<span class="k">val</span> <span class="n">okForm</span> <span class="k">=</span> <span class="nc">RegistrationForm</span><span class="o">(</span><span class="s">&quot;john@example.com&quot;</span><span class="o">,</span> <span class="s">&quot;John&quot;</span><span class="o">,</span> <span class="s">&quot;s3cr3t&quot;</span><span class="o">,</span> <span class="s">&quot;40&quot;</span><span class="o">)</span>

<span class="k">val</span> <span class="n">resultOk</span> <span class="k">=</span> <span class="n">okForm</span>
  <span class="o">.</span><span class="n">intoPartial</span><span class="o">[</span><span class="kt">RegisteredUser</span><span class="o">]</span>
  <span class="o">.</span><span class="n">withFieldComputed</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">passwordHash</span><span class="o">,</span> <span class="n">form</span> <span class="k">=&gt;</span> <span class="n">hashpw</span><span class="o">(</span><span class="n">form</span><span class="o">.</span><span class="n">password</span><span class="o">))</span>
  <span class="o">.</span><span class="n">withFieldComputedPartial</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">age</span><span class="o">,</span> <span class="n">form</span> <span class="k">=&gt;</span> <span class="n">partial</span><span class="o">.</span><span class="nc">Result</span><span class="o">.</span><span class="n">fromOption</span><span class="o">(</span><span class="n">form</span><span class="o">.</span><span class="n">age</span><span class="o">.</span><span class="n">toIntOption</span><span class="o">))</span>
  <span class="o">.</span><span class="n">transform</span>
<span class="c1">// resultOk: partial.Result[RegisteredUser] = Value(</span>
<span class="c1">//   RegisteredUser(&quot;john@example.com&quot;, &quot;John&quot;, &quot;...&quot;, 40)</span>
<span class="c1">// )</span>
</pre></div>
</div>
<p>Partial transformation returns a special result type <code class="docutils literal notranslate"><span class="pre">partial.Result</span></code>. There are few methods that are
useful to convert such a result to more familiar types.</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">resultOk</span><span class="o">.</span><span class="n">asOption</span> <span class="c1">// Some(RegisteredUser(&quot;john@example.com&quot;, &quot;John&quot;, &quot;...&quot;, 40))</span>
<span class="n">resultOk</span><span class="o">.</span><span class="n">asEither</span> <span class="c1">// Right(RegisteredUser(&quot;john@example.com&quot;, &quot;John&quot;, &quot;...&quot;, 40))</span>
</pre></div>
</div>
<div class="section" id="capturing-errors">
<h2>Capturing errors<a class="headerlink" href="#capturing-errors" title="Permalink to this headline">¶</a></h2>
<p>Let’s see how partial transformers can handle failure scenarios.</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">badForm</span> <span class="k">=</span> <span class="nc">RegistrationForm</span><span class="o">(</span><span class="s">&quot;john@example.com&quot;</span><span class="o">,</span> <span class="s">&quot;John&quot;</span><span class="o">,</span> <span class="s">&quot;s3cr3t&quot;</span><span class="o">,</span> <span class="s">&quot;not a number&quot;</span><span class="o">)</span>

<span class="k">val</span> <span class="n">resultBad</span> <span class="k">=</span> <span class="n">badForm</span>
  <span class="o">.</span><span class="n">intoPartial</span><span class="o">[</span><span class="kt">RegisteredUser</span><span class="o">]</span>
  <span class="o">.</span><span class="n">withFieldComputed</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">passwordHash</span><span class="o">,</span> <span class="n">form</span> <span class="k">=&gt;</span> <span class="n">hashpw</span><span class="o">(</span><span class="n">form</span><span class="o">.</span><span class="n">password</span><span class="o">))</span>
  <span class="o">.</span><span class="n">withFieldComputedPartial</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">age</span><span class="o">,</span> <span class="n">form</span> <span class="k">=&gt;</span> <span class="n">partial</span><span class="o">.</span><span class="nc">Result</span><span class="o">.</span><span class="n">fromOption</span><span class="o">(</span><span class="n">form</span><span class="o">.</span><span class="n">age</span><span class="o">.</span><span class="n">toIntOption</span><span class="o">))</span>
  <span class="o">.</span><span class="n">transform</span>
<span class="c1">// resultBad: partial.Result[RegisteredUser] = Errors(</span>
<span class="c1">//   Iterable(Error(message = EmptyValue, path = ErrorPath(elems = List(Accessor(name = &quot;age&quot;)))))</span>
<span class="c1">// )</span>
</pre></div>
</div>
<p>In this case, we provided illegal string value for field <code class="docutils literal notranslate"><span class="pre">age</span></code>, which is not parsable to an integer.
The whole transformation now returned error case, providing additional information about the affected fields.</p>
<p>There are few ways how you can access the error information.</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">resultBad</span><span class="o">.</span><span class="n">asOption</span> <span class="c1">// None</span>
<span class="n">resultBad</span><span class="o">.</span><span class="n">asEither</span> <span class="c1">// Left(Errors(Iterable(...)))</span>

<span class="c1">// you can pattern match against the result type</span>
<span class="n">resultBad</span> <span class="k">match</span> <span class="o">{</span>
  <span class="k">case</span> <span class="n">partial</span><span class="o">.</span><span class="nc">Result</span><span class="o">.</span><span class="nc">Value</span><span class="o">(</span><span class="n">value</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">println</span><span class="o">(</span><span class="s">s&quot;transformed to: </span><span class="si">$value</span><span class="s">&quot;</span><span class="o">)</span>
  <span class="k">case</span> <span class="n">partial</span><span class="o">.</span><span class="nc">Result</span><span class="o">.</span><span class="nc">Errors</span><span class="o">(</span><span class="n">errors</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">println</span><span class="o">(</span><span class="s">s&quot;got </span><span class="si">${</span><span class="n">errors</span><span class="o">.</span><span class="n">size</span><span class="si">}</span><span class="s"> errors&quot;</span><span class="o">)</span>
<span class="o">}</span>

<span class="c1">// additional convenience methods for quick accessing error information,</span>
<span class="c1">// together with path to the affected field</span>
<span class="n">resultBad</span><span class="o">.</span><span class="n">asErrorPathMessages</span> <span class="c1">// List((&quot;age&quot;, partial.ErrorMessage.EmptyValue))</span>
<span class="n">resultBad</span><span class="o">.</span><span class="n">asErrorPathMessageStrings</span> <span class="c1">// List((&quot;age&quot;, &quot;empty value&quot;))</span>
</pre></div>
</div>
<p>See also <a class="reference internal" href="cats-integration.html#partial-cats-integration"><span class="std std-ref">Cats integration</span></a> for other ways of accessing error info.</p>
</div>
<div class="section" id="custom-error-messages">
<h2>Custom error messages<a class="headerlink" href="#custom-error-messages" title="Permalink to this headline">¶</a></h2>
<p>So far we were receiving <cite>EmptyValue</cite> error, as we just provided <code class="docutils literal notranslate"><span class="pre">Option[Int]</span></code> value to
<code class="docutils literal notranslate"><span class="pre">withFieldComputedPartial</span></code>, which can’t represent any more detailed error information.</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">import</span> <span class="nn">io.scalaland.chimney.dsl._</span>
<span class="k">import</span> <span class="nn">io.scalaland.chimney.partial</span>
<span class="k">import</span> <span class="nn">scala.util.</span><span class="o">{</span><span class="nc">Try</span><span class="o">,</span> <span class="nc">Success</span><span class="o">,</span> <span class="nc">Failure</span><span class="o">}</span>

<span class="k">val</span> <span class="n">resultBad2</span> <span class="k">=</span> <span class="n">badForm</span>
  <span class="o">.</span><span class="n">intoPartial</span><span class="o">[</span><span class="kt">RegisteredUser</span><span class="o">]</span>
  <span class="o">.</span><span class="n">withFieldComputed</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">passwordHash</span><span class="o">,</span> <span class="n">form</span> <span class="k">=&gt;</span> <span class="n">hashpw</span><span class="o">(</span><span class="n">form</span><span class="o">.</span><span class="n">password</span><span class="o">))</span>
  <span class="o">.</span><span class="n">withFieldComputedPartial</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">age</span><span class="o">,</span> <span class="n">form</span> <span class="k">=&gt;</span> <span class="o">{</span>
    <span class="nc">Try</span><span class="o">(</span><span class="n">form</span><span class="o">.</span><span class="n">age</span><span class="o">.</span><span class="n">toInt</span><span class="o">)</span> <span class="k">match</span> <span class="o">{</span>
      <span class="k">case</span> <span class="nc">Success</span><span class="o">(</span><span class="n">value</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">partial</span><span class="o">.</span><span class="nc">Result</span><span class="o">.</span><span class="n">fromValue</span><span class="o">(</span><span class="n">value</span><span class="o">)</span>
      <span class="k">case</span> <span class="nc">Failure</span><span class="o">(</span><span class="n">why</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">partial</span><span class="o">.</span><span class="nc">Result</span><span class="o">.</span><span class="n">fromErrorString</span><span class="o">(</span><span class="n">why</span><span class="o">.</span><span class="n">toString</span><span class="o">)</span>
    <span class="o">}</span>
  <span class="o">})</span>
  <span class="o">.</span><span class="n">transform</span>
<span class="c1">// resultBad2: partial.Result[RegisteredUser] = Errors(</span>
<span class="c1">//   Iterable(Error(message = StringMessage(&quot;&quot;java.lang.NumberFormatException: For input string: \&quot;not a number\&quot;&quot;&quot;), path = ErrorPath(elems = List(Accessor(name = &quot;age&quot;)))))</span>
<span class="c1">// )</span>

<span class="n">resultBad2</span><span class="o">.</span><span class="n">asErrorPathMessages</span> <span class="c1">// List((&quot;age&quot;, StringMessage(&quot;java.lang.NumberFormatException: For input string: \&quot;not a number\&quot;&quot;)))</span>
<span class="n">resultBad2</span><span class="o">.</span><span class="n">asErrorPathMessageStrings</span> <span class="c1">// List((&quot;age&quot;, &quot;java.lang.NumberFormatException: For input string: \&quot;not a number\&quot;&quot;))</span>
</pre></div>
</div>
<p>Now we wrapped the exception-throwing <code class="docutils literal notranslate"><span class="pre">form.age.toInt</span></code> into a <code class="docutils literal notranslate"><span class="pre">Try</span></code> and manually propagated detailed error message
to the <code class="docutils literal notranslate"><span class="pre">PartialTransformer</span></code> computation. More or less the same result could be achieved using built-in <code class="docutils literal notranslate"><span class="pre">Try</span></code> integration.</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">withFieldComputedPartial</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">age</span><span class="o">,</span> <span class="n">form</span> <span class="k">=&gt;</span> <span class="n">partial</span><span class="o">.</span><span class="nc">Result</span><span class="o">.</span><span class="n">fromTry</span><span class="o">(</span><span class="nc">Try</span><span class="o">(</span><span class="n">form</span><span class="o">.</span><span class="n">age</span><span class="o">.</span><span class="n">toInt</span><span class="o">)))</span>

<span class="c1">// or catching the exception directly, without Try acting as intermediary</span>
<span class="n">withFieldComputedPartial</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">age</span><span class="o">,</span> <span class="n">form</span> <span class="k">=&gt;</span> <span class="n">partial</span><span class="o">.</span><span class="nc">Result</span><span class="o">.</span><span class="n">fromCatching</span><span class="o">(</span><span class="n">form</span><span class="o">.</span><span class="n">age</span><span class="o">.</span><span class="n">toInt</span><span class="o">))</span>
</pre></div>
</div>
</div>
<div class="section" id="partial-transformers-operations">
<h2>Partial transformers operations<a class="headerlink" href="#partial-transformers-operations" title="Permalink to this headline">¶</a></h2>
<p>Similar to <code class="docutils literal notranslate"><span class="pre">withFieldConst</span></code>, <code class="docutils literal notranslate"><span class="pre">withFieldComputed</span></code>, <code class="docutils literal notranslate"><span class="pre">withCoproductInstance</span></code> operations,
there are partial counterparts available:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">withFieldConstPartial</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">withFieldComputedPartial</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">withCoproductInstancePartial</span></code></p></li>
</ul>
<p>Analogously to <a class="reference internal" href="../transformers/own-transformations.html#transformer-definition-dsl"><span class="std std-ref">Transformer definition DSL</span></a> for <code class="docutils literal notranslate"><span class="pre">Transformer</span></code>, we can define above transformation
as implicit <code class="docutils literal notranslate"><span class="pre">PartialTransformer[RegistrationForm,</span> <span class="pre">RegisteredUser]</span></code>. In order to do this,
we use <code class="docutils literal notranslate"><span class="pre">PartialTransformer.define</span></code> (or equivalently <code class="docutils literal notranslate"><span class="pre">Transformer.definePartial</span></code>).</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">import</span> <span class="nn">io.scalaland.chimney._</span>
<span class="k">import</span> <span class="nn">io.scalaland.chimney.dsl._</span>
<span class="k">import</span> <span class="nn">io.scalaland.chimney.partial</span>

<span class="k">implicit</span> <span class="k">val</span> <span class="n">transformer</span><span class="k">:</span> <span class="kt">PartialTransformer</span><span class="o">[</span><span class="kt">RegistrationForm</span><span class="p">,</span> <span class="kt">RegisteredUser</span><span class="o">]</span> <span class="k">=</span>
  <span class="nc">PartialTransformer</span><span class="o">.</span><span class="n">define</span><span class="o">[</span><span class="kt">RegistrationForm</span><span class="p">,</span> <span class="kt">RegisteredUser</span><span class="o">]</span>
    <span class="o">.</span><span class="n">withFieldComputed</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">passwordHash</span><span class="o">,</span> <span class="n">form</span> <span class="k">=&gt;</span> <span class="n">hashpw</span><span class="o">(</span><span class="n">form</span><span class="o">.</span><span class="n">password</span><span class="o">))</span>
    <span class="o">.</span><span class="n">withFieldComputedPartial</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">age</span><span class="o">,</span> <span class="n">form</span> <span class="k">=&gt;</span> <span class="n">partial</span><span class="o">.</span><span class="nc">Result</span><span class="o">.</span><span class="n">fromCatching</span><span class="o">(</span><span class="n">form</span><span class="o">.</span><span class="n">age</span><span class="o">.</span><span class="n">toInt</span><span class="o">))</span>
    <span class="o">.</span><span class="n">buildTransformer</span>
</pre></div>
</div>
<p>Such an instance may be later picked up and used by other partial transformations.
In the following example it’s used for transforming array of registration forms into list of registered users.</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="nc">Array</span><span class="o">(</span><span class="n">okForm</span><span class="o">,</span> <span class="n">badForm</span><span class="o">).</span><span class="n">transformIntoPartial</span><span class="o">[</span><span class="kt">List</span><span class="o">[</span><span class="kt">RegisteredUser</span><span class="o">]]</span>
<span class="c1">// ...: partial.Result[List[RegisteredUser]]</span>
</pre></div>
</div>
<p>You can expect that basic functionality of chimney’s <code class="docutils literal notranslate"><span class="pre">Transformer</span></code> either works in the similar
fashion in <code class="docutils literal notranslate"><span class="pre">PartialTransformer</span></code>s, or have some counterparty methods in the API
(usually with the <cite>Partial</cite> prefix or suffix in the name).</p>
</div>
<div class="section" id="short-circuit-semantics">
<h2>Short-circuit semantics<a class="headerlink" href="#short-circuit-semantics" title="Permalink to this headline">¶</a></h2>
<p>By default, partial transformers work in the error-accumulating mode, meaning that given the first
error, they progress the computation to capture all the possible errors that might happen later.</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="nc">Array</span><span class="o">(</span><span class="n">badForm</span><span class="o">,</span> <span class="n">okForm</span><span class="o">,</span> <span class="n">badForm</span><span class="o">.</span><span class="n">copy</span><span class="o">(</span><span class="n">age</span> <span class="k">=</span> <span class="kc">null</span><span class="o">))</span>
  <span class="o">.</span><span class="n">transformIntoPartial</span><span class="o">[</span><span class="kt">List</span><span class="o">[</span><span class="kt">RegisteredUser</span><span class="o">]]</span>
  <span class="o">.</span><span class="n">asErrorPathMessageStrings</span>
<span class="c1">// List(</span>
<span class="c1">//   (&quot;(0).age&quot;, &quot;For input string: \&quot;not a number\&quot;&quot;),</span>
<span class="c1">//   (&quot;(2).age&quot;, &quot;Cannot parse null string&quot;)</span>
<span class="c1">// )</span>
</pre></div>
</div>
<p>Sometimes error accumulation might be not what we want, especially when errors are heavy to compute
and we just want to have quick feedback if the transformation passes or not. In such cases we would like to
fail fast, as the first error appears. We can easily switch to such a behavior.</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="nc">Array</span><span class="o">(</span><span class="n">badForm</span><span class="o">,</span> <span class="n">okForm</span><span class="o">,</span> <span class="n">badForm</span><span class="o">.</span><span class="n">copy</span><span class="o">(</span><span class="n">age</span> <span class="k">=</span> <span class="kc">null</span><span class="o">))</span>
  <span class="o">.</span><span class="n">intoPartial</span><span class="o">[</span><span class="kt">List</span><span class="o">[</span><span class="kt">RegisteredUser</span><span class="o">]]</span>
  <span class="o">.</span><span class="n">transformFailFast</span>
  <span class="o">.</span><span class="n">asErrorPathMessageStrings</span>
<span class="c1">// List(</span>
<span class="c1">//   (&quot;(0).age&quot;, &quot;For input string: \&quot;not a number\&quot;&quot;),</span>
<span class="c1">// )</span>
</pre></div>
</div>
<p>Now we received only the first error, as requested.</p>
</div>
<div class="section" id="performance-notes">
<h2>Performance notes<a class="headerlink" href="#performance-notes" title="Permalink to this headline">¶</a></h2>
<p>Partial transformers were implemented with the high performance and low computation overhead in mind.
There are several optimizations in place to make them as performant as possible.</p>
<p>Our partial transformer composition encoding is optimized to use flat data structures, producing low amount of
garbage and use lazy memory allocation.</p>
<p>There is a custom, <a class="reference external" href="https://github.com/non/chain">chain</a>-like data structure optimized for gathering
partial transformer errors, supporting fast append/merge and having a special treatment of error paths annotations.</p>
<p>Check our <a class="reference internal" href="../benchmarks.html#benchmarks"><span class="std std-ref">Benchmarks</span></a> suite for more detailed comparison.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="migrating-from-lifted.html" class="btn btn-neutral float-right" title="Migrating from Lifted Transformers" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../transformers/unsafe-options.html" class="btn btn-neutral float-left" title="Unsafe options (deprecated)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2017-2023, scalaland.io

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    <!-- Theme Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-116165806-1', 'auto');
    ga('send', 'pageview');
    </script>

    
   

</body>
</html>