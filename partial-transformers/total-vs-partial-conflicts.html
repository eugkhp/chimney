

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Total vs partial conflicts &mdash; Chimney 0.7.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Cats integration" href="cats-integration.html" />
    <link rel="prev" title="Migrating from Lifted Transformers" href="migrating-from-lifted.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> Chimney
          

          
          </a>

          
            
            
              <div class="version">
                0.7.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting-started/quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting-started/community.html">Community</a></li>
</ul>
<p class="caption"><span class="caption-text">Transformers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../transformers/getting-started.html">Getting started with transformers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../transformers/customizing-transformers.html">Customizing transformers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../transformers/standard-transformers.html">Standard transformers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../transformers/default-values.html">Default values support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../transformers/own-transformations.html">Plugging in own transformations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../transformers/scoped-configuration.html">Providing scoped configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../transformers/java-beans.html">Java beans</a></li>
<li class="toctree-l1"><a class="reference internal" href="../transformers/unsafe-options.html">Unsafe options <code class="docutils literal notranslate"><span class="pre">(deprecated)</span></code></a></li>
</ul>
<p class="caption"><span class="caption-text">Partial Transformers</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="partial-transformers.html">Partial transformers</a></li>
<li class="toctree-l1"><a class="reference internal" href="migrating-from-lifted.html">Migrating from Lifted Transformers</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Total vs partial conflicts</a></li>
<li class="toctree-l1"><a class="reference internal" href="cats-integration.html">Cats integration</a></li>
</ul>
<p class="caption"><span class="caption-text">Lifted Transformers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../lifted-transformers/lifted-transformers.html">Lifted Transformers <code class="docutils literal notranslate"><span class="pre">(deprecated)</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../lifted-transformers/cats-integration.html">Cats integration <code class="docutils literal notranslate"><span class="pre">(deprecated)</span></code></a></li>
</ul>
<p class="caption"><span class="caption-text">Patchers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../patchers/getting-started.html">Getting started with patchers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../patchers/redundant-fields.html">Redundant fields in patchers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../patchers/options-handling.html">Handling optional fields</a></li>
</ul>
<p class="caption"><span class="caption-text">Benchmarks</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../benchmarks.html">Benchmarks</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Chimney</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Total vs partial conflicts</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="total-vs-partial-conflicts">
<span id="id1"></span><h1>Total vs partial conflicts<a class="headerlink" href="#total-vs-partial-conflicts" title="Permalink to this headline">Â¶</a></h1>
<p>Under normal circumstances when fields or sealed hierarchy subtypes should be converted, Chimney should be able
to generate code on its own. If it cannot you could provide it with derivation settings or implicit transformer handling
problematic fields/subtypes.</p>
<p>It can use total transformers</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">import</span> <span class="nn">io.scalaland.chimney._</span>
<span class="k">import</span> <span class="nn">io.scalaland.chimney.dsl._</span>

<span class="k">case</span> <span class="k">class</span> <span class="nc">UserAPI</span><span class="o">(</span><span class="n">credits</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span>
<span class="k">case</span> <span class="k">class</span> <span class="nc">User</span><span class="o">(</span><span class="n">credits</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span>

<span class="k">implicit</span> <span class="k">val</span> <span class="n">unsafeStringToInt</span><span class="k">:</span> <span class="kt">Transformer</span><span class="o">[</span><span class="kt">String</span><span class="p">,</span> <span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="k">_</span><span class="o">.</span><span class="n">toInt</span>

<span class="nc">UserAPI</span><span class="o">(</span><span class="s">&quot;10&quot;</span><span class="o">).</span><span class="n">transformIntoPartial</span><span class="o">[</span><span class="kt">User</span><span class="o">].</span><span class="n">asOption</span> <span class="c1">// Some(User(10))</span>
</pre></div>
</div>
<p>or partial transformer</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">import</span> <span class="nn">io.scalaland.chimney._</span>
<span class="k">import</span> <span class="nn">io.scalaland.chimney.dsl._</span>

<span class="k">case</span> <span class="k">class</span> <span class="nc">UserAPI</span><span class="o">(</span><span class="n">credits</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span>
<span class="k">case</span> <span class="k">class</span> <span class="nc">User</span><span class="o">(</span><span class="n">credits</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span>

<span class="k">implicit</span> <span class="k">val</span> <span class="n">parseStringToInt</span><span class="k">:</span> <span class="kt">PartialTransformer</span><span class="o">[</span><span class="kt">String</span><span class="p">,</span> <span class="kt">Int</span><span class="o">]</span> <span class="k">=</span>
  <span class="nc">PartialTransformer</span><span class="o">[</span><span class="kt">String</span><span class="p">,</span> <span class="kt">Int</span><span class="o">](</span><span class="n">str</span> <span class="k">=&gt;</span> <span class="n">partial</span><span class="o">.</span><span class="nc">Result</span><span class="o">.</span><span class="n">fromCatching</span><span class="o">(</span><span class="n">str</span><span class="o">.</span><span class="n">toInt</span><span class="o">).</span><span class="n">map</span><span class="o">(</span><span class="k">_</span> <span class="o">*</span> <span class="mi">2</span><span class="o">))</span>

<span class="nc">UserAPI</span><span class="o">(</span><span class="s">&quot;10&quot;</span><span class="o">).</span><span class="n">transformIntoPartial</span><span class="o">[</span><span class="kt">User</span><span class="o">].</span><span class="n">asOption</span> <span class="c1">// Some(User(20))</span>
</pre></div>
</div>
<p>But which implicit should be taken in this situation?</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">import</span> <span class="nn">io.scalaland.chimney._</span>
<span class="k">import</span> <span class="nn">io.scalaland.chimney.dsl._</span>

<span class="k">case</span> <span class="k">class</span> <span class="nc">UserAPI</span><span class="o">(</span><span class="n">credits</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span>
<span class="k">case</span> <span class="k">class</span> <span class="nc">User</span><span class="o">(</span><span class="n">credits</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span>

<span class="k">implicit</span> <span class="k">val</span> <span class="n">unsafeStringToInt</span><span class="k">:</span> <span class="kt">Transformer</span><span class="o">[</span><span class="kt">String</span><span class="p">,</span> <span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="k">_</span><span class="o">.</span><span class="n">toInt</span>

<span class="k">implicit</span> <span class="k">val</span> <span class="n">parseStringToInt</span><span class="k">:</span> <span class="kt">PartialTransformer</span><span class="o">[</span><span class="kt">String</span><span class="p">,</span> <span class="kt">Int</span><span class="o">]</span> <span class="k">=</span>
  <span class="nc">PartialTransformer</span><span class="o">[</span><span class="kt">String</span><span class="p">,</span> <span class="kt">Int</span><span class="o">](</span><span class="n">str</span> <span class="k">=&gt;</span> <span class="n">partial</span><span class="o">.</span><span class="nc">Result</span><span class="o">.</span><span class="n">fromCatching</span><span class="o">(</span><span class="n">str</span><span class="o">.</span><span class="n">toInt</span><span class="o">).</span><span class="n">map</span><span class="o">(</span><span class="k">_</span> <span class="o">*</span> <span class="mi">2</span><span class="o">))</span>

<span class="nc">UserAPI</span><span class="o">(</span><span class="s">&quot;10&quot;</span><span class="o">).</span><span class="n">transformIntoPartial</span><span class="o">[</span><span class="kt">User</span><span class="o">].</span><span class="n">asOption</span>
<span class="c1">// error: Ambiguous implicits while resolving Chimney recursive transformation:</span>
<span class="c1">//</span>
<span class="c1">//        PartialTransformer[String, Int]: parseStringToInt</span>
<span class="c1">//        Transformer[String, Int]: unsafeStringToInt</span>
</pre></div>
</div>
<p>To avoid the ambiguity, Chimney would fail the derivation in such case and expect you to tell it, which transformer it
should prefer: total or partial:</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">import</span> <span class="nn">io.scalaland.chimney._</span>
<span class="k">import</span> <span class="nn">io.scalaland.chimney.dsl._</span>

<span class="k">case</span> <span class="k">class</span> <span class="nc">UserAPI</span><span class="o">(</span><span class="n">credits</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span>
<span class="k">case</span> <span class="k">class</span> <span class="nc">User</span><span class="o">(</span><span class="n">credits</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span>

<span class="k">implicit</span> <span class="k">val</span> <span class="n">unsafeStringToInt</span><span class="k">:</span> <span class="kt">Transformer</span><span class="o">[</span><span class="kt">String</span><span class="p">,</span> <span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="k">_</span><span class="o">.</span><span class="n">toInt</span>

<span class="k">implicit</span> <span class="k">val</span> <span class="n">parseStringToInt</span><span class="k">:</span> <span class="kt">PartialTransformer</span><span class="o">[</span><span class="kt">String</span><span class="p">,</span> <span class="kt">Int</span><span class="o">]</span> <span class="k">=</span>
  <span class="nc">PartialTransformer</span><span class="o">[</span><span class="kt">String</span><span class="p">,</span> <span class="kt">Int</span><span class="o">](</span><span class="n">str</span> <span class="k">=&gt;</span> <span class="n">partial</span><span class="o">.</span><span class="nc">Result</span><span class="o">.</span><span class="n">fromCatching</span><span class="o">(</span><span class="n">str</span><span class="o">.</span><span class="n">toInt</span><span class="o">).</span><span class="n">map</span><span class="o">(</span><span class="k">_</span> <span class="o">*</span> <span class="mi">2</span><span class="o">))</span>

<span class="nc">UserAPI</span><span class="o">(</span><span class="s">&quot;10&quot;</span><span class="o">).</span><span class="n">intoPartial</span><span class="o">[</span><span class="kt">User</span><span class="o">]</span>
  <span class="o">.</span><span class="n">enableImplicitConflictResolution</span><span class="o">(</span><span class="nc">PreferTotalTransformer</span><span class="o">)</span>
  <span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">asOption</span> <span class="c1">// Some(User(10))</span>

<span class="nc">UserAPI</span><span class="o">(</span><span class="s">&quot;10&quot;</span><span class="o">).</span><span class="n">intoPartial</span><span class="o">[</span><span class="kt">User</span><span class="o">]</span>
  <span class="o">.</span><span class="n">enableImplicitConflictResolution</span><span class="o">(</span><span class="nc">PreferPartialTransformer</span><span class="o">)</span>
  <span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">asOption</span> <span class="c1">// Some(User(20))</span>
</pre></div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="cats-integration.html" class="btn btn-neutral float-right" title="Cats integration" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="migrating-from-lifted.html" class="btn btn-neutral float-left" title="Migrating from Lifted Transformers" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2017-2023, scalaland.io

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    <!-- Theme Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-116165806-1', 'auto');
    ga('send', 'pageview');
    </script>

    
   

</body>
</html>